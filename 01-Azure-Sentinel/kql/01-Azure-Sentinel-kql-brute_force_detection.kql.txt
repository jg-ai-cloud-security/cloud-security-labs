// Brute Force Detection (Starter)
// Looks for multiple failed sign-ins from the same IP within a short period

SigninLogs
| where TimeGenerated > ago(24h)
| where ResultType != 0
| summarize FailedAttempts=count(), Users=make_set(UserPrincipalName, 10)
    by IPAddress, bin(TimeGenerated, 15m)
| where FailedAttempts >= 10
| order by FailedAttempts desc
